@app.route('/register')
def register():
    return render_template('register.html')

@app.route('/api/register', methods=['POST'])
def api_register():
    username = request.json.get('username')
    password = request.json.get('password')
    expiry_days = int(request.json.get('expiry_days'))
    expiry_date = datetime.utcnow() + timedelta(days=expiry_days)
    
    existing_user = User.query.filter_by(username=username).first()
    if existing_user:
        return jsonify({'message': '이미 존재하는 사용자명입니다.', 'category': 'error'}), 400
    
    hashed_password = generate_password_hash(password)
    new_user = User(username=username, password=hashed_password, expiry_date=expiry_date)
    db.session.add(new_user)
    db.session.commit()
    return jsonify({'message': '등록이 완료되었습니다.', 'category': 'success'})
